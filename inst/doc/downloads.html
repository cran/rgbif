<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Scott Chamberlain" />

<meta name="date" content="2020-07-22" />

<title>Downloading data from GBIF</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Downloading data from GBIF</h1>
<h4 class="author">Scott Chamberlain</h4>
<h4 class="date">2020-07-22</h4>



<div id="gbif-downloads" class="section level1">
<h1>GBIF Downloads</h1>
<p>GBIF provides two ways to get occurrence data: through the <code>/occurrence/search</code> route (see <code>occ_search()</code> and <code>occ_data()</code>), or via the <code>/occurrence/download</code> route (many functions, see below). <code>occ_search()</code>/<code>occ_data()</code> are more appropriate for smaller data, while <code>occ_download*()</code> functions are more appropriate for larger data requests. Note that the download service is equivalent to downloading a dataset from the GBIF website - but doing it here makes it reproducible (and easier once you learn the ropes)!</p>
<p>The download functions are:</p>
<ul>
<li><code>occ_download()</code> - Start a download</li>
<li><code>occ_download_prep()</code> - Prepare a download request</li>
<li><code>occ_download_queue()</code> - Start many downloads in a queue</li>
<li><code>occ_download_meta()</code> - Get metadata progress on a single download</li>
<li><code>occ_download_list()</code> - List your downloads</li>
<li><code>occ_download_cancel()</code> - Cancel a download</li>
<li><code>occ_download_cancel_staged()</code> - Cancels any jobs with status <code>RUNNING</code> or <code>PREPARING</code></li>
<li><code>occ_download_get()</code> - Retrieve a download</li>
<li><code>occ_download_import()</code> - Import a download from local file system</li>
<li><code>occ_download_datasets()</code> - List datasets for a download</li>
<li><code>occ_download_dataset_activity()</code> - Lists the downloads activity of a dataset</li>
</ul>
<p>The following functions are the download predicate DSL, used with <code>occ_download</code>, <code>occ_download_prep()</code>, and <code>occ_download_queue()</code>.</p>
<p><code>pred*</code> functions are named for the ‘type’ of operation they do, following the terminology used by GBIF, see <a href="https://www.gbif.org/developer/occurrence#predicates" class="uri">https://www.gbif.org/developer/occurrence#predicates</a></p>
<p>Function names are given, with the equivalent GBIF type value (e.g., <code>pred_gt</code> and <code>greaterThan</code>)</p>
<p>The following functions take one key and one value:</p>
<ul>
<li><code>pred</code>: equals</li>
<li><code>pred_lt</code>: lessThan</li>
<li><code>pred_lte</code>: lessThanOrEquals</li>
<li><code>pred_gt</code>: greaterThan</li>
<li><code>pred_gte</code>: greaterThanOrEquals</li>
<li><code>pred_not</code>: not</li>
<li><code>pred_like</code>: like</li>
</ul>
<p>The following function is only for geospatial queries, and only accepts a WKT string:</p>
<ul>
<li><code>pred_within</code>: within</li>
</ul>
<p>The following function is only for stating the you don’t want a key to be null, so only accepts one key:</p>
<ul>
<li><code>pred_notnull</code>: isNotNull</li>
</ul>
<p>The following two functions accept multiple individual predicates, separating them by either “and” or “or”:</p>
<ul>
<li><code>pred_and</code>: and</li>
<li><code>pred_or</code>: or</li>
</ul>
<p>The following function is special in that it accepts a single key but many values; stating that you want to search for all the values:</p>
<ul>
<li><code>pred_in</code>: in</li>
</ul>
<p><code>occ_download()</code> is the function to start off with when using the GBIF download service. With it you can specify what query you want. Unfortunately, the interfaces to the search vs. download services are different, so we couldn’t make the <code>rgbif</code> interface to <code>occ_search</code>/<code>occ_data</code> the same as <code>occ_download</code>.</p>
<p>Be aware that you can only perform 3 downloads simultaneously, so plan wisely. To help with this limitation, we are working on a queue helper, but it’s not ready yet.</p>
<p>Let’s take a look at how to use the download functions.</p>
<div id="load-rgbif" class="section level2">
<h2>Load rgbif</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&quot;rgbif&quot;</span>)</span></code></pre></div>
</div>
<div id="kick-off-a-download" class="section level2">
<h2>Kick off a download</h2>
<p>Instead of passing parameters like <code>taxonkey = 12345</code> in <code>occ_search</code>, for downloads we construct queries using any of the <code>pred</code> functions. This provides for much more complex queries than can be done with <code>occ_search/occ_data</code>. With downloads, you can use operators other than <code>=</code> (equal to); and the queries can be very complex.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>(res &lt;-<span class="st"> </span><span class="kw">occ_download</span>(<span class="kw">pred</span>(<span class="st">&#39;taxonKey&#39;</span>, <span class="dv">7264332</span>), <span class="kw">pred</span>(<span class="st">&#39;hasCoordinate&#39;</span>, <span class="ot">TRUE</span>)))</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt; &lt;&lt;gbif download&gt;&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt;   Username: sckott</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt;   E-mail: myrmecocystus@gmail.com</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;   Download key: 0000796-171109162308116</span></span></code></pre></div>
<p>What <code>occ_download</code> returns is not the data itself! When you send the request to GBIF, they have to prepare it first, then when it’s done you can download it.</p>
<p>What <code>occ_download</code> returns is some useful metadata that tells you about the download, and helps us check and know when the download is done.</p>
</div>
<div id="check-download-status" class="section level2">
<h2>Check download status</h2>
<p>After running <code>occ_download</code>, we can pass the resulting object to <code>occ_download_meta</code> - with primary goal of checking the download status.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">occ_download_meta</span>(res)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; &lt;&lt;gbif download metadata&gt;&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt;   Status: PREPARING</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt;   Format: DWCA</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt;   Download key: 0000796-171109162308116</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt;   Created: 2017-11-10T19:30:32.328+0000</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt;   Modified: 2017-11-10T19:30:44.590+0000</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;   Download link: http://api.gbif.org/v1/occurrence/download/request/0000796-171109162308116.zip</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt;   Total records: 1425</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt;   Request:</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt;     type:  and</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt;     predicates:</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt;       &gt; type: equals, key: TAXON_KEY, value: 7264332</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt;       &gt; type: equals, key: HAS_COORDINATE, value: TRUE</span></span></code></pre></div>
<p>Continue running <code>occ_download_meta</code> until the <code>Status</code> value is <code>SUCCEEDED</code> or <code>KILLED</code>. If it is <code>KILLED</code> that means something went wrong - get in touch with us. If <code>SUCCEEDED</code>, then you can proceed to the next step (downloading the data with <code>occ_download_get</code>).</p>
<p>Before we go to the next step, there’s another function to help you out.</p>
<p>With <code>occ_download_list</code> you can get an overview of all your download requests, with</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>x &lt;-<span class="st"> </span><span class="kw">occ_download_list</span>()</span>
<span id="cb4-2"><a href="#cb4-2"></a>x<span class="op">$</span>results &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(x<span class="op">$</span>results)</span>
<span id="cb4-3"><a href="#cb4-3"></a>x</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; $meta</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt;   offset limit endofrecords count</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; 1      0    20        FALSE   211</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; $results</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; # A tibble: 20 x 18</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt;                        key                    doi</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt;  *                   &lt;chr&gt;                  &lt;chr&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt;  1 0000796-171109162308116 doi:10.15468/dl.nv3r5p</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt;  2 0000739-171109162308116 doi:10.15468/dl.jmachn</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt;  3 0000198-171109162308116 doi:10.15468/dl.t5wjpe</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt;  4 0000122-171020152545675 doi:10.15468/dl.yghxj7</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt;  5 0000119-171020152545675 doi:10.15468/dl.qiowtc</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt;  6 0000115-171020152545675 doi:10.15468/dl.tdbkzn</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt;  7 0010067-170714134226665 doi:10.15468/dl.ro6qj1</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt;  8 0010066-170714134226665 doi:10.15468/dl.bhekhi</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt;  9 0010065-170714134226665 doi:10.15468/dl.xy4nfp</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt; 10 0010064-170714134226665 doi:10.15468/dl.hsqp84</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#&gt; 11 0010062-170714134226665 doi:10.15468/dl.h2apik</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#&gt; 12 0010061-170714134226665 doi:10.15468/dl.1srstq</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">#&gt; 13 0010059-170714134226665 doi:10.15468/dl.2me5hk</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="co">#&gt; 14 0010058-170714134226665 doi:10.15468/dl.sjmxvf</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">#&gt; 15 0010057-170714134226665 doi:10.15468/dl.f28182</span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">#&gt; 16 0010056-170714134226665 doi:10.15468/dl.4t2qim</span></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">#&gt; 17 0010055-170714134226665 doi:10.15468/dl.lumz7s</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">#&gt; 18 0010054-170714134226665 doi:10.15468/dl.wfkgqm</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">#&gt; 19 0010053-170714134226665 doi:10.15468/dl.fintow</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="co">#&gt; 20 0010050-170714134226665 doi:10.15468/dl.a2h9gu</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="co">#&gt; # ... with 16 more variables: license &lt;chr&gt;, created &lt;chr&gt;, modified &lt;chr&gt;,</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="co">#&gt; #   status &lt;chr&gt;, downloadLink &lt;chr&gt;, size &lt;dbl&gt;, totalRecords &lt;int&gt;,</span></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="co">#&gt; #   numberDatasets &lt;int&gt;, request.creator &lt;chr&gt;, request.format &lt;chr&gt;,</span></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="co">#&gt; #   request.notificationAddresses &lt;list&gt;, request.sendNotification &lt;lgl&gt;,</span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="co">#&gt; #   request.predicate.type &lt;chr&gt;, request.predicate.predicates &lt;list&gt;,</span></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="co">#&gt; #   request.predicate.key &lt;chr&gt;, request.predicate.value &lt;chr&gt;</span></span></code></pre></div>
</div>
<div id="canceling-downloads" class="section level2">
<h2>Canceling downloads</h2>
<p>If for some reason you need to cancel a download you can do so with <code>occ_download_cancel</code> or <code>occ_download_cancel_staged</code>.</p>
<p><code>occ_download_cancel</code> cancels a job by download key, while <code>occ_download_cancel_staged</code> cancels all jobs in <code>PREPARING</code> or <code>RUNNING</code> stage.</p>
</div>
<div id="fetch-data" class="section level2">
<h2>Fetch data</h2>
<p>After you see the <code>SUCCEEDED</code> status on calling <code>occ_download_meta</code>, you can then download the data using <code>occ_download_get</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>(dat &lt;-<span class="st"> </span><span class="kw">occ_download_get</span>(<span class="st">&quot;0000796-171109162308116&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; &lt;&lt;gbif downloaded get&gt;&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;   Path: ./0000796-171109162308116.zip</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;   File size: 0.35 MB</span></span></code></pre></div>
<p>This only download data to your machine - it does not read it into R. You can now move on to importing into R.</p>
</div>
<div id="import-data-into-r" class="section level2">
<h2>Import data into R</h2>
<p>Pass the output of <code>occ_download_get</code> directly to <code>occ_download_import</code> - they can be piped together if you like.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">occ_download_get</span>(<span class="st">&quot;0000796-171109162308116&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">occ_download_import</span>()</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># OR</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>dat &lt;-<span class="st"> </span><span class="kw">occ_download_get</span>(<span class="st">&quot;0000796-171109162308116&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">occ_download_import</span>(dat)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; # A tibble: 1,425 x 235</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt;        gbifID abstract accessRights accrualMethod accrualPeriodicity</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;         &lt;int&gt;    &lt;lgl&gt;        &lt;chr&gt;         &lt;lgl&gt;              &lt;lgl&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt;  1 1667184715       NA                         NA                 NA</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt;  2 1667182218       NA                         NA                 NA</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt;  3 1667179996       NA                         NA                 NA</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt;  4 1667179527       NA                         NA                 NA</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt;  5 1667171607       NA                         NA                 NA</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt;  6 1667165448       NA                         NA                 NA</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt;  7 1667163154       NA                         NA                 NA</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt;  8 1667162324       NA                         NA                 NA</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt;  9 1667162162       NA                         NA                 NA</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; 10 1667161552       NA                         NA                 NA</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; # ... with 1,415 more rows, and 230 more variables: accrualPolicy &lt;lgl&gt;,</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; #   alternative &lt;lgl&gt;, audience &lt;lgl&gt;, available &lt;lgl&gt;,</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; #   bibliographicCitation &lt;lgl&gt;, conformsTo &lt;lgl&gt;, contributor &lt;lgl&gt;,</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt; #   coverage &lt;lgl&gt;, created &lt;lgl&gt;, creator &lt;lgl&gt;, date &lt;lgl&gt;,</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; #   dateAccepted &lt;lgl&gt;, dateCopyrighted &lt;lgl&gt;, dateSubmitted &lt;lgl&gt;,</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; #   description &lt;lgl&gt;, educationLevel &lt;lgl&gt;, extent &lt;lgl&gt;, format &lt;lgl&gt;,</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt; #   hasFormat &lt;lgl&gt;, hasPart &lt;lgl&gt;, hasVersion &lt;lgl&gt;, identifier &lt;chr&gt;,</span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt;</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; ... cut for brevity</span></span></code></pre></div>
</div>
<div id="citing-download-data" class="section level2">
<h2>Citing download data</h2>
<p>The nice thing about data retrieved via GBIF’s download service is that they provide DOIs for each download, so that you can give a link that resolves to the download with metadata on GBIF’s website. And it makes for a nice citation.</p>
<p>Using the funciton <code>gbif_citaiton</code> we can get citations for our downloads, with the output from <code>occ_download_get</code> or <code>occ_download_meta</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">occ_download_meta</span>(res) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gbif_citation</span>()</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; $download</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; [1] &quot;GBIF Occurrence Download https://doi.org/10.15468/dl.ohjevv Accessed from R via rgbif (https://github.com/ropensci/rgbif) on 2017-11-10&quot;</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; $datasets</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>You’ll notice that the <code>datasets</code> slot is <code>NULL</code> - because when using <code>occ_download_meta</code>, we don’t yet have any information about which datasets are in the download.</p>
<p>But if you use <code>occ_download_get</code> you then have the individual datasets, and we can get citatations for each idividual dataset in addition to the entire download.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">occ_download_get</span>(<span class="st">&quot;0000796-171109162308116&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gbif_citation</span>()</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; $download</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt; [1] &quot;GBIF Occurrence Download https://doi.org/10.15468/dl.nv3r5p Accessed from R via rgbif (https://github.com/ropensci/rgbif) on 2017-11-10&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; $datasets</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; $datasets[[1]]</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; &lt;&lt;rgbif citation&gt;&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;    Citation: Office of Environment &amp; Heritage (2017). OEH Atlas of NSW</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;         Wildlife. Occurrence Dataset https://doi.org/10.15468/14jd9g accessed</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt;         via GBIF.org on 2017-11-10.. Accessed from R via rgbif</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt;         (https://github.com/ropensci/rgbif) on 2017-11-10</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt;    Rights: This work is licensed under a Creative Commons Attribution (CC-BY)</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt;         4.0 License.</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; $datasets[[2]]</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt; &lt;&lt;rgbif citation&gt;&gt;</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt;    Citation: Creuwels J (2017). Naturalis Biodiversity Center (NL) - Botany.</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt;         Naturalis Biodiversity Center. Occurrence Dataset</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt;         https://doi.org/10.15468/ib5ypt accessed via GBIF.org on 2017-11-10..</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt;         Accessed from R via rgbif (https://github.com/ropensci/rgbif) on</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt;         2017-11-10</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt;    Rights: To the extent possible under law, the publisher has waived all</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt;         rights to these data and has dedicated them to the Public Domain (CC0</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt;         1.0). Users may copy, modify, distribute and use the work, including</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt;         for commercial purposes, without restriction.</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; ... cutoff for brevity</span></span></code></pre></div>
<p>Here, we get the overall citation as well as citations (and data rights) for each dataset.</p>
<p>Please do cite the data you use from GBIF!</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
